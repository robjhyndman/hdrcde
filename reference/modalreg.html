<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nonparametric Multimodal Regression — modalreg • hdrcde</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Nonparametric Multimodal Regression — modalreg"><meta name="description" content="Nonparametric multi-valued regression based on the modes of conditional
density estimates."><meta property="og:description" content="Nonparametric multi-valued regression based on the modes of conditional
density estimates."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hdrcde</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Change Log</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/robjhyndman/hdrcde"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Nonparametric Multimodal Regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/hdrcde/blob/master/R/modalreg.r" class="external-link"><code>R/modalreg.r</code></a></small>
      <div class="d-none name"><code>modalreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Nonparametric multi-valued regression based on the modes of conditional
density estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modalreg</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  xfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, l <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  deg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  P <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"e"</span>,</span>
<span>  prun <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prun.const <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numerical vector: the conditioning variable.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Numerical vector: the response variable.</p></dd>


<dt id="arg-xfix">xfix<a class="anchor" aria-label="anchor" href="#arg-xfix"></a></dt>
<dd><p>Numerical vector corresponding to the input values of which the
fitted values shall be calculated.</p></dd>


<dt id="arg-a">a<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>Optional bandwidth in \(x\)-direction.</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Optional bandwidth in \(y\)-direction.</p></dd>


<dt id="arg-deg">deg<a class="anchor" aria-label="anchor" href="#arg-deg"></a></dt>
<dd><p>Degree of local polynomial used in estimation (0 or 1).</p></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>Positive integer giving the number of mean shift iterations per
point and branch.</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Maximal number of branches.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Character determining how the starting points are selected.
<code>"q"</code>: proportional to quantiles; <code>"e"</code>: equidistant; <code>"r"</code>:
random.  All, <code>"q"</code>, <code>"e"</code>, and <code>"r"</code>, give starting points
which are constant over <code>x</code>.  As an alternative, the choice <code>"v"</code>
gives variable starting points, which are equal to <code>"q"</code> for the
smallest <code>x</code>, and equal to the previously fitted values for all
subsequent <code>x</code>.</p></dd>


<dt id="arg-prun">prun<a class="anchor" aria-label="anchor" href="#arg-prun"></a></dt>
<dd><p>Boolean. If TRUE, parts of branches are dismissed (in the
plotted output) where their associated kernel density value falls below the
threshold <code>1/(prun.const*(max(x)-min(x))*(max(y)-min(y)))</code>.</p></dd>


<dt id="arg-prun-const">prun.const<a class="anchor" aria-label="anchor" href="#arg-prun-const"></a></dt>
<dd><p>Numerical value giving the constant used above (the
higher, the less pruning)</p></dd>


<dt id="arg-plot-type">plot.type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>Vector with two elements. The first one is
character-valued, with possible values <code>"p"</code>, <code>"l"</code>, and
<code>"n"</code>.  If equal to <code>"n"</code>, no plotted output is given at all. If
equal to <code>"p"</code>, fitted curves are symbolized as points in the graphical
output, otherwise as lines.  The second vector component is a numerical
value either being 0 or 1. If 1, the position of the starting points is
depicted in the plot, otherwise omitted.</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>Vector of three character strings.  The first one is the
"main" title of the graphical output, the second one is the label of the
\(x\) axis, and the third one the label of the \(y\) axis.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>Plotting character. The default corresponds to small bullets.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to <code><a href="cde.bandwidths.html">cde.bandwidths()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following components:</p>
<dl><dt>xfix</dt>
<dd><p>Grid of predictor
values at which the fitted values are calculated.</p></dd>
 <dt>fitted.values</dt>
<dd><p>A
<code>P</code> x <code>length(xfix)</code> matrix with fitted j-th branch in the j-th row
(\(1 \le j \le P\))</p></dd>
 <dt>bandwidths</dt>
<dd><p>A vector with
bandwidths <code>a</code> and <code>b</code>.</p></dd>
 <dt>density</dt>
<dd><p>A <code>[P x length(xfix)]</code>- matrix with estimated kernel densities. This will only be
computed if <code>prun=TRUE</code>.</p></dd>
 <dt>threshold</dt>
<dd><p>The pruning threshold.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Computes multi-modal nonparametric regression curves based on the maxima of
conditional density estimates. The tool for the estimation is the
conditional mean shift as outlined in Einbeck and Tutz (2006).  Estimates of
the conditional modes might fluctuate highly if <code>deg=1</code>.  Hence,
<code>deg=0</code> is recommended. For bandwidth selection, the hybrid rule
introduced by Bashtannyk and Hyndman (2001) is employed if <code>deg=0</code>.
This corresponds to the setting <code>method=1</code> in function
<code>cde.bandwidths</code>. For <code>deg=1</code> automatic bandwidth selection is not
supported.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Einbeck, J., and Tutz, G. (2006) "Modelling beyond regression
functions: an application of multimodal regression to speed-flow data".
<em>Journal of the Royal Statistical Society, Series C (Applied
Statistics)</em>, <strong>55</strong>, 461-475.</p>
<p>Bashtannyk, D.M., and Hyndman, R.J. (2001) "Bandwidth selection for kernel
conditional density estimation". <em>Computational Statistics and Data
Analysis</em>, <strong>36</strong>(3), 279-298.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cde.bandwidths.html">cde.bandwidths()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jochen Einbeck (2007)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">lane2.fit</span> <span class="op">&lt;-</span> <span class="fu">modalreg</span><span class="op">(</span><span class="va">lane2</span><span class="op">$</span><span class="va">flow</span>, <span class="va">lane2</span><span class="op">$</span><span class="va">speed</span>, xfix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span> <span class="op">*</span> <span class="fl">40</span>, a <span class="op">=</span> <span class="fl">100</span>, b <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="modalreg-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="http://robjhyndman.com" class="external-link">Rob Hyndman</a>, Jochen Einbeck, Matthew Wand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

