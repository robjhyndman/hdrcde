<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nonparametric Multimodal Regression — modalreg • hdrcde</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Nonparametric Multimodal Regression — modalreg" />
<meta property="og:description" content="Nonparametric multi-valued regression based on the modes of conditional
density estimates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hdrcde</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robjhyndman/hdrcde">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nonparametric Multimodal Regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/robjhyndman/hdrcde/blob/master/R/modalreg.r'><code>R/modalreg.r</code></a></small>
    <div class="hidden name"><code>modalreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Nonparametric multi-valued regression based on the modes of conditional
density estimates.</p>
    </div>

    <pre class="usage"><span class='fu'>modalreg</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  xfix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, l <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,
  <span class='va'>a</span>,
  <span class='va'>b</span>,
  deg <span class='op'>=</span> <span class='fl'>0</span>,
  iter <span class='op'>=</span> <span class='fl'>30</span>,
  P <span class='op'>=</span> <span class='fl'>2</span>,
  start <span class='op'>=</span> <span class='st'>"e"</span>,
  prun <span class='op'>=</span> <span class='cn'>TRUE</span>,
  prun.const <span class='op'>=</span> <span class='fl'>10</span>,
  plot.type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"p"</span>, <span class='fl'>1</span><span class='op'>)</span>,
  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span>,
  pch <span class='op'>=</span> <span class='fl'>20</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Numerical vector: the conditioning variable.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Numerical vector: the response variable.</p></td>
    </tr>
    <tr>
      <th>xfix</th>
      <td><p>Numerical vector corresponding to the input values of which the
fitted values shall be calculated.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Optional bandwidth in \(x\)-direction.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Optional bandwidth in \(y\)-direction.</p></td>
    </tr>
    <tr>
      <th>deg</th>
      <td><p>Degree of local polynomial used in estimation (0 or 1).</p></td>
    </tr>
    <tr>
      <th>iter</th>
      <td><p>Positive integer giving the number of mean shift iterations per
point and branch.</p></td>
    </tr>
    <tr>
      <th>P</th>
      <td><p>Maximal number of branches.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>Character determining how the starting points are selected.
<code>"q"</code>: proportional to quantiles; <code>"e"</code>: equidistant; <code>"r"</code>:
random.  All, <code>"q"</code>, <code>"e"</code>, and <code>"r"</code>, give starting points
which are constant over <code>x</code>.  As an alternative, the choice <code>"v"</code>
gives variable starting points, which are equal to <code>"q"</code> for the
smallest <code>x</code>, and equal to the previously fitted values for all
subsequent <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>prun</th>
      <td><p>Boolean. If TRUE, parts of branches are dismissed (in the
plotted output) where their associated kernel density value falls below the
threshold <code>1/(prun.const*(max(x)-min(x))*(max(y)-min(y)))</code>.</p></td>
    </tr>
    <tr>
      <th>prun.const</th>
      <td><p>Numerical value giving the constant used above (the
higher, the less pruning)</p></td>
    </tr>
    <tr>
      <th>plot.type</th>
      <td><p>Vector with two elements. The first one is
character-valued, with possible values <code>"p"</code>, <code>"l"</code>, and
<code>"n"</code>.  If equal to <code>"n"</code>, no plotted output is given at all. If
equal to <code>"p"</code>, fitted curves are symbolized as points in the graphical
output, otherwise as lines.  The second vector component is a numerical
value either being 0 or 1. If 1, the position of the starting points is
depicted in the plot, otherwise omitted.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Vector of three character strings.  The first one is the
"main" title of the graphical output, the second one is the label of the
\(x\) axis, and the third one the label of the \(y\) axis.</p></td>
    </tr>
    <tr>
      <th>pch</th>
      <td><p>Plotting character. The default corresponds to small bullets.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to <code><a href='cde.bandwidths.html'>cde.bandwidths</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt>xfix</dt><dd><p>Grid of predictor
values at which the fitted values are calculated.</p></dd> <dt>fitted.values</dt><dd><p>A
<code>[P x length(xfix)]</code>- matrix with fitted j-th branch in the j-th row
(\(1 \le j \le P\))</p></dd> <dt>bandwidths</dt><dd><p>A vector with
bandwidths <code>a</code> and <code>b</code>.</p></dd> <dt>density</dt><dd><p>A <code>[P x
length(xfix)]</code>- matrix with estimated kernel densities. This will only be
computed if <code>prun=TRUE</code>.</p></dd> <dt>threshold</dt><dd><p>The pruning threshold.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Computes multi-modal nonparametric regression curves based on the maxima of
conditional density estimates. The tool for the estimation is the
conditional mean shift as outlined in Einbeck and Tutz (2006).  Estimates of
the conditional modes might fluctuate highly if <code>deg=1</code>.  Hence,
<code>deg=0</code> is recommended. For bandwidth selection, the hybrid rule
introduced by Bashtannyk and Hyndman (2001) is employed if <code>deg=0</code>.
This corresponds to the setting <code>method=1</code> in function
<code>cde.bandwidths</code>. For <code>deg=1</code> automatic bandwidth selection is not
supported.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Einbeck, J., and Tutz, G. (2006) "Modelling beyond regression
functions: an application of multimodal regression to speed-flow data".
<em>Journal of the Royal Statistical Society, Series C (Applied
Statistics)</em>, <b>55</b>, 461-475.</p>
<p>Bashtannyk, D.M., and Hyndman, R.J. (2001) "Bandwidth selection for kernel
conditional density estimation". <em>Computational Statistics and Data
Analysis</em>, <b>36</b>(3), 279-298.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cde.bandwidths.html'>cde.bandwidths</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jochen Einbeck (2007)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>lane2.fit</span> <span class='op'>&lt;-</span> <span class='fu'>modalreg</span><span class='op'>(</span><span class='va'>lane2</span><span class='op'>$</span><span class='va'>flow</span>, <span class='va'>lane2</span><span class='op'>$</span><span class='va'>speed</span>, xfix<span class='op'>=</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>55</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>40</span>, a<span class='op'>=</span><span class='fl'>100</span>, b<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='img'><img src='modalreg-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 10 ..20 ..30 ..40 ..50 ..</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://robjhyndman.com'>Rob Hyndman</a>, Jochen Einbeck, Matthew Wand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


