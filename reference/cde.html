<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Conditional Density Estimation — cde • hdrcde</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Conditional Density Estimation — cde" />
<meta property="og:description" content="Calculates kernel conditional density estimate using local polynomial
estimation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hdrcde</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change Log</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robjhyndman/hdrcde">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Conditional Density Estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/robjhyndman/hdrcde/blob/master/R/cde.est.R'><code>R/cde.est.R</code></a></small>
    <div class="hidden name"><code>cde.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates kernel conditional density estimate using local polynomial
estimation.</p>
    </div>

    <pre class="usage"><span class='fu'>cde</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  deg <span class='op'>=</span> <span class='fl'>0</span>,
  link <span class='op'>=</span> <span class='st'>"identity"</span>,
  <span class='va'>a</span>,
  <span class='va'>b</span>,
  mean <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>x.margin</span>,
  <span class='va'>y.margin</span>,
  <span class='va'>x.name</span>,
  <span class='va'>y.name</span>,
  use.locfit <span class='op'>=</span> <span class='cn'>FALSE</span>,
  fw <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rescale <span class='op'>=</span> <span class='cn'>TRUE</span>,
  nxmargin <span class='op'>=</span> <span class='fl'>15</span>,
  nymargin <span class='op'>=</span> <span class='fl'>100</span>,
  a.nndefault <span class='op'>=</span> <span class='fl'>0.3</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Numerical vector or matrix: the conditioning variable(s).</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>Numerical vector: the response variable.</p></td>
    </tr>
    <tr>
      <th>deg</th>
      <td><p>Degree of local polynomial used in estimation.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>Link function used in estimation. Default "identity". The other
possibility is "log" which is recommended if degree &gt; 0.</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>Optional bandwidth in x direction.</p></td>
    </tr>
    <tr>
      <th>b</th>
      <td><p>Optional bandwidth in y direction.</p></td>
    </tr>
    <tr>
      <th>mean</th>
      <td><p>Estimated mean of y|x. If present, it will adjust conditional
density to have this mean.</p></td>
    </tr>
    <tr>
      <th>x.margin</th>
      <td><p>Values in x-space on which conditional density is
calculated. If not specified, an equi-spaced grid of <code>nxmargin</code> values
over the range of x is used.  If x is a matrix, x.margin should be a list of
two numerical vectors.</p></td>
    </tr>
    <tr>
      <th>y.margin</th>
      <td><p>Values in y-space on which conditional density is
calculated. If not specified, an equi-spaced grid of <code>nymargin</code> values
over the range of y is used.</p></td>
    </tr>
    <tr>
      <th>x.name</th>
      <td><p>Optional name of x variable used in plots.</p></td>
    </tr>
    <tr>
      <th>y.name</th>
      <td><p>Optional name of y variable used in plots.</p></td>
    </tr>
    <tr>
      <th>use.locfit</th>
      <td><p>If TRUE, will use <code><a href='https://rdrr.io/pkg/locfit/man/locfit.html'>locfit</a></code> for
estimation. Otherwise <code><a href='https://rdrr.io/r/stats/ksmooth.html'>ksmooth</a></code> is used.
<code><a href='https://rdrr.io/pkg/locfit/man/locfit.html'>locfit</a></code> is used if degree&gt;0 or link not the identity or
the dimension of x is greater than 1 even if <code>use.locfit=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>fw</th>
      <td><p>If TRUE (default), will use fixed window width estimation.
Otherwise nearest neighbourhood estimation is used. If the dimension of x is
greater than 1, nearest neighbourhood must be used.</p></td>
    </tr>
    <tr>
      <th>rescale</th>
      <td><p>If TRUE (default), will rescale the conditional densities to
integrate to one.</p></td>
    </tr>
    <tr>
      <th>nxmargin</th>
      <td><p>Number of values used in <code>x.margin</code> by default.</p></td>
    </tr>
    <tr>
      <th>nymargin</th>
      <td><p>Number of values used in <code>y.margin</code> by default.</p></td>
    </tr>
    <tr>
      <th>a.nndefault</th>
      <td><p>Default nearest neighbour bandwidth (used only if
<code>fw=FALSE</code> and <code>a</code> is missing.).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments are passed to locfit.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt>x</dt><dd><p>grid in x direction
on which density evaluated. Equal to x.margin if specified.</p></dd> <dt>y</dt><dd><p>grid
in y direction on which density is evaluated. Equal to y.margin if
specified.</p></dd> <dt>z</dt><dd><p>value of conditional density estimate returned as a
matrix.</p></dd> <dt>a</dt><dd><p>window width in x direction.</p></dd> <dt>b</dt><dd><p>window width in y
direction.</p></dd> <dt>x.name</dt><dd><p>Name of x variable to be used in plots.</p></dd>
<dt>y.name</dt><dd><p>Name of y variable to be used in plots.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If bandwidths are omitted, they are computed using normal reference rules
described in Bashtannyk and Hyndman (2001) and Hyndman and Yao (2002). Bias
adjustment uses the method described in Hyndman, Bashtannyk and Grunwald
(1996). If deg&gt;1 then estimation is based on the local parametric estimator
of Hyndman and Yao (2002).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hyndman, R.J., Bashtannyk, D.M. and Grunwald, G.K. (1996)
"Estimating and visualizing conditional densities". <em>Journal of
Computational and Graphical Statistics</em>, <b>5</b>, 315-336.</p>
<p>Bashtannyk, D.M., and Hyndman, R.J. (2001) "Bandwidth selection for kernel
conditional density estimation". <em>Computational statistics and data
analysis</em>, <b>36</b>(3), 279-298.</p>
<p>Hyndman, R.J. and Yao, Q. (2002) "Nonparametric estimation and symmetry
tests for conditional density functions". <em>Journal of Nonparametric
Statistics</em>, <b>14</b>(3), 259-278.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cde.bandwidths.html'>cde.bandwidths</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Rob J Hyndman</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Old faithful data</span>
<span class='va'>faithful.cde</span> <span class='op'>&lt;-</span> <span class='fu'>cde</span><span class='op'>(</span><span class='va'>faithful</span><span class='op'>$</span><span class='va'>waiting</span>, <span class='va'>faithful</span><span class='op'>$</span><span class='va'>eruptions</span>,
  x.name<span class='op'>=</span><span class='st'>"Waiting time"</span>, y.name<span class='op'>=</span><span class='st'>"Duration time"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>faithful.cde</span><span class='op'>)</span>
</div><div class='img'><img src='cde-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>faithful.cde</span>, plot.fn<span class='op'>=</span><span class='st'>"hdr"</span><span class='op'>)</span>
</div><div class='img'><img src='cde-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Melbourne maximum temperatures with bias adjustment</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>maxtemp</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3649</span><span class='op'>]</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>maxtemp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>3650</span><span class='op'>]</span>
<span class='va'>maxtemp.cde</span> <span class='op'>&lt;-</span> <span class='fu'>cde</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,
  x.name<span class='op'>=</span><span class='st'>"Today's max temperature"</span>,y.name<span class='op'>=</span><span class='st'>"Tomorrow's max temperature"</span><span class='op'>)</span>
<span class='co'># Assume linear mean</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>~</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>fit.mean</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>45</span>,y<span class='op'>=</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>coef</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='va'>fit</span><span class='op'>$</span><span class='va'>coef</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>45</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>maxtemp.cde2</span> <span class='op'>&lt;-</span> <span class='fu'>cde</span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span>,mean<span class='op'>=</span><span class='va'>fit.mean</span>,
  x.name<span class='op'>=</span><span class='st'>"Today's max temperature"</span>,y.name<span class='op'>=</span><span class='st'>"Tomorrow's max temperature"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>maxtemp.cde</span><span class='op'>)</span>
</div><div class='img'><img src='cde-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://robjhyndman.com'>Rob Hyndman</a>, Jochen Einbeck, Matthew Wand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


