<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates kernel conditional density estimate using local polynomial
estimation."><title>Conditional Density Estimation — cde • hdrcde</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Conditional Density Estimation — cde"><meta property="og:description" content="Calculates kernel conditional density estimate using local polynomial
estimation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hack-font@3/build/web/hack-subset.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hdrcde</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Change Log</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/robjhyndman/hdrcde">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Conditional Density Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/robjhyndman/hdrcde/blob/HEAD/R/cde.est.R" class="external-link"><code>R/cde.est.R</code></a></small>
      <div class="d-none name"><code>cde.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates kernel conditional density estimate using local polynomial
estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cde</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  deg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">x.margin</span>,</span>
<span>  <span class="va">y.margin</span>,</span>
<span>  <span class="va">x.name</span>,</span>
<span>  <span class="va">y.name</span>,</span>
<span>  use.locfit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fw <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rescale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nxmargin <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  nymargin <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  a.nndefault <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Numerical vector or matrix: the conditioning variable(s).</p></dd>


<dt>y</dt>
<dd><p>Numerical vector: the response variable.</p></dd>


<dt>deg</dt>
<dd><p>Degree of local polynomial used in estimation.</p></dd>


<dt>link</dt>
<dd><p>Link function used in estimation. Default "identity". The other
possibility is "log" which is recommended if degree &gt; 0.</p></dd>


<dt>a</dt>
<dd><p>Optional bandwidth in x direction.</p></dd>


<dt>b</dt>
<dd><p>Optional bandwidth in y direction.</p></dd>


<dt>mean</dt>
<dd><p>Estimated mean of y|x. If present, it will adjust conditional
density to have this mean.</p></dd>


<dt>x.margin</dt>
<dd><p>Values in x-space on which conditional density is
calculated. If not specified, an equi-spaced grid of <code>nxmargin</code> values
over the range of x is used.  If x is a matrix, x.margin should be a list of
two numerical vectors.</p></dd>


<dt>y.margin</dt>
<dd><p>Values in y-space on which conditional density is
calculated. If not specified, an equi-spaced grid of <code>nymargin</code> values
over the range of y is used.</p></dd>


<dt>x.name</dt>
<dd><p>Optional name of x variable used in plots.</p></dd>


<dt>y.name</dt>
<dd><p>Optional name of y variable used in plots.</p></dd>


<dt>use.locfit</dt>
<dd><p>If TRUE, will use <code><a href="https://rdrr.io/pkg/locfit/man/locfit.html" class="external-link">locfit</a></code> for
estimation. Otherwise <code><a href="https://rdrr.io/r/stats/ksmooth.html" class="external-link">ksmooth</a></code> is used.
<code><a href="https://rdrr.io/pkg/locfit/man/locfit.html" class="external-link">locfit</a></code> is used if degree&gt;0 or link not the identity or
the dimension of x is greater than 1 even if <code>use.locfit=FALSE</code>.</p></dd>


<dt>fw</dt>
<dd><p>If TRUE (default), will use fixed window width estimation.
Otherwise nearest neighbourhood estimation is used. If the dimension of x is
greater than 1, nearest neighbourhood must be used.</p></dd>


<dt>rescale</dt>
<dd><p>If TRUE (default), will rescale the conditional densities to
integrate to one.</p></dd>


<dt>nxmargin</dt>
<dd><p>Number of values used in <code>x.margin</code> by default.</p></dd>


<dt>nymargin</dt>
<dd><p>Number of values used in <code>y.margin</code> by default.</p></dd>


<dt>a.nndefault</dt>
<dd><p>Default nearest neighbour bandwidth (used only if
<code>fw=FALSE</code> and <code>a</code> is missing.).</p></dd>


<dt>...</dt>
<dd><p>Additional arguments are passed to locfit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with the following components:</p>
<dl><dt>x</dt>
<dd><p>grid in x direction
on which density evaluated. Equal to x.margin if specified.</p></dd>
 <dt>y</dt>
<dd><p>grid
in y direction on which density is evaluated. Equal to y.margin if
specified.</p></dd>
 <dt>z</dt>
<dd><p>value of conditional density estimate returned as a
matrix.</p></dd>
 <dt>a</dt>
<dd><p>window width in x direction.</p></dd>
 <dt>b</dt>
<dd><p>window width in y
direction.</p></dd>
 <dt>x.name</dt>
<dd><p>Name of x variable to be used in plots.</p></dd>

<dt>y.name</dt>
<dd><p>Name of y variable to be used in plots.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If bandwidths are omitted, they are computed using normal reference rules
described in Bashtannyk and Hyndman (2001) and Hyndman and Yao (2002). Bias
adjustment uses the method described in Hyndman, Bashtannyk and Grunwald
(1996). If deg&gt;1 then estimation is based on the local parametric estimator
of Hyndman and Yao (2002).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hyndman, R.J., Bashtannyk, D.M. and Grunwald, G.K. (1996)
"Estimating and visualizing conditional densities". <em>Journal of
Computational and Graphical Statistics</em>, <b>5</b>, 315-336.</p>
<p>Bashtannyk, D.M., and Hyndman, R.J. (2001) "Bandwidth selection for kernel
conditional density estimation". <em>Computational statistics and data
analysis</em>, <b>36</b>(3), 279-298.</p>
<p>Hyndman, R.J. and Yao, Q. (2002) "Nonparametric estimation and symmetry
tests for conditional density functions". <em>Journal of Nonparametric
Statistics</em>, <b>14</b>(3), 259-278.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="cde.bandwidths.html">cde.bandwidths</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rob J Hyndman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Old faithful data</span></span></span>
<span class="r-in"><span><span class="va">faithful.cde</span> <span class="op">&lt;-</span> <span class="fu">cde</span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">waiting</span>, <span class="va">faithful</span><span class="op">$</span><span class="va">eruptions</span>,</span></span>
<span class="r-in"><span>  x.name<span class="op">=</span><span class="st">"Waiting time"</span>, y.name<span class="op">=</span><span class="st">"Duration time"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">faithful.cde</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cde-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">faithful.cde</span>, plot.fn<span class="op">=</span><span class="st">"hdr"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cde-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Melbourne maximum temperatures with bias adjustment</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">maxtemp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3649</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">maxtemp</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3650</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">maxtemp.cde</span> <span class="op">&lt;-</span> <span class="fu">cde</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>,</span></span>
<span class="r-in"><span>  x.name<span class="op">=</span><span class="st">"Today's max temperature"</span>, y.name<span class="op">=</span><span class="st">"Tomorrow's max temperature"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Assume linear mean</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">6</span><span class="op">:</span><span class="fl">45</span>,y<span class="op">=</span><span class="va">fit</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">fit</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">maxtemp.cde2</span> <span class="op">&lt;-</span> <span class="fu">cde</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, mean<span class="op">=</span><span class="va">fit.mean</span>,</span></span>
<span class="r-in"><span>   x.name<span class="op">=</span><span class="st">"Today's max temperature"</span>, y.name<span class="op">=</span><span class="st">"Tomorrow's max temperature"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">maxtemp.cde</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cde-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://robjhyndman.com" class="external-link">Rob Hyndman</a>, Jochen Einbeck, Matthew Wand.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

